(()=>{var e={};e.id=6903,e.ids=[6903],e.modules={53524:e=>{"use strict";e.exports=require("@prisma/client")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},32081:e=>{"use strict";e.exports=require("child_process")},6113:e=>{"use strict";e.exports=require("crypto")},9523:e=>{"use strict";e.exports=require("dns")},82361:e=>{"use strict";e.exports=require("events")},57147:e=>{"use strict";e.exports=require("fs")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},41808:e=>{"use strict";e.exports=require("net")},22037:e=>{"use strict";e.exports=require("os")},71017:e=>{"use strict";e.exports=require("path")},63477:e=>{"use strict";e.exports=require("querystring")},12781:e=>{"use strict";e.exports=require("stream")},24404:e=>{"use strict";e.exports=require("tls")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},72944:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>a.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var s=t(55336),i=t(7623),n=t(63328),a=t.n(n),o=t(25798),l={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);t.d(r,l);let d=["",{children:["(dashboard)",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,65651)),"/Users/morganfuller/Documents/Invoke/ReelSearch/temp/ReelSearch/app/(dashboard)/dashboard/page.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,70746)),"/Users/morganfuller/Documents/Invoke/ReelSearch/temp/ReelSearch/app/(dashboard)/dashboard/layout.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,62286)),"/Users/morganfuller/Documents/Invoke/ReelSearch/temp/ReelSearch/app/(dashboard)/dashboard/loading.tsx"]}]},{"not-found":[()=>Promise.resolve().then(t.t.bind(t,78824,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[],apple:[],openGraph:[async e=>(await Promise.resolve().then(t.bind(t,8010))).default(e)],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,98416)),"/Users/morganfuller/Documents/Invoke/ReelSearch/temp/ReelSearch/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,78824,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[],apple:[],openGraph:[async e=>(await Promise.resolve().then(t.bind(t,8010))).default(e)],twitter:[],manifest:void 0}}],c=["/Users/morganfuller/Documents/Invoke/ReelSearch/temp/ReelSearch/app/(dashboard)/dashboard/page.tsx"],u="/(dashboard)/dashboard/page",p={require:t,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/(dashboard)/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},5559:(e,r,t)=>{Promise.resolve().then(t.bind(t,58425))},58425:(e,r,t)=>{"use strict";t.r(r),t.d(r,{BillingForm:()=>c});var s=t(35213),i=t(97910),n=t(35014),a=t(29669),o=t(26044),l=t(23980),d=t(94109);function c({subscriptionPlan:e,className:r,...t}){let[c,u]=i.useState(!1);async function p(e){e.preventDefault(),u(!c);let r=await fetch("/api/users/stripe");if(console.log("response",r),!r?.ok)return(0,l.Am)({title:"Something went wrong.",description:"Please refresh the page and try again.",variant:"destructive"});let t=await r.json();window.location.href=t.url}return s.jsx("form",{className:(0,n.cn)(r),onSubmit:p,...t,children:(0,s.jsxs)(o.Zb,{children:[(0,s.jsxs)(o.Ol,{children:[s.jsx(o.ll,{children:"Subscription Plan"}),(0,s.jsxs)(o.SZ,{children:["You are currently on the ",s.jsx("strong",{children:e.name})," ","plan."]})]}),s.jsx(o.aY,{style:{display:"flex",flexDirection:"column"},children:s.jsx(s.Fragment,{children:e.description})}),s.jsx(o.aY,{style:{display:"flex",flexDirection:"column",marginTop:0}}),(0,s.jsxs)(o.eW,{className:"flex flex-col items-start space-y-2 md:flex-row md:justify-between md:space-x-0",children:[(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"row"},children:[(0,s.jsxs)("button",{type:"submit",className:(0,n.cn)((0,a.d)(),"initiateCheckoutEventbutton"),disabled:c,children:[c&&s.jsx(d.P.spinner,{className:"mr-2 h-4 w-4 animate-spin"}),e.isPro?"Manage Subscription":"Upgrade to PRO"]}),(0,s.jsxs)(o.SZ,{style:{display:"flex",flexDirection:"column",marginLeft:10},children:[s.jsx("p",{children:e.isPro?null:"5 Day Pro Plan Free Trial"}),s.jsx("p",{children:e.isPro?null:"No Credit Card Required"})]})]}),e.isPro?(0,s.jsxs)("p",{className:"rounded-full text-xs font-medium",children:[e.isCanceled?"Your plan will be canceled on ":"Your plan renews on ",(0,n.p)(e.stripeCurrentPeriodEnd),"."]}):null]})]})})}},65651:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>m,metadata:()=>p});var s=t(18844),i=t(57785),n=t(75409),a=t(5249),o=t(95431),l=t(78827),d=t(74362),c=t(441),u=t(3808);let p={title:"Billing",description:"Manage billing and your subscription plan."};async function m(){let e=await (0,a.t)();e||(0,i.redirect)(n.L?.pages?.signIn||"/login");let r=await (0,l.b)(e.id),t=!1;return r.isPro&&r.stripeSubscriptionId&&(t=(await o.A.subscriptions.retrieve(r.stripeSubscriptionId)).cancel_at_period_end),(0,s.jsxs)(u.r,{children:[s.jsx(c.x,{heading:"Billing",text:"Manage billing and your subscription plan."}),s.jsx("div",{className:"grid gap-8",children:s.jsx(d.U,{subscriptionPlan:{...r,isCanceled:t}})})]})}},74362:(e,r,t)=>{"use strict";t.d(r,{U:()=>o});var s=t(34186);let i=(0,s.createProxy)(String.raw`/Users/morganfuller/Documents/Invoke/ReelSearch/temp/ReelSearch/components/billing-form.tsx`),{__esModule:n,$$typeof:a}=i;i.default;let o=(0,s.createProxy)(String.raw`/Users/morganfuller/Documents/Invoke/ReelSearch/temp/ReelSearch/components/billing-form.tsx#BillingForm`)},85685:(e,r,t)=>{"use strict";t.d(r,{H:()=>n,R:()=>i});var s=t(47980);let i={name:"Free",description:"The free plan has limited features to view daily vehicle pricing data.",stripePriceId:""},n={name:"PRO",description:"PRO plan: Advanced data vizualization, revenue and market analysis, plus reelSearch+ChatGPT",stripePriceId:s.O.STRIPE_PRO_MONTHLY_PLAN_ID||""}},95431:(e,r,t)=>{"use strict";t.d(r,{A:()=>n});var s=t(42774),i=t(47980);let n=new s.Z(i.O.STRIPE_API_KEY,{apiVersion:"2022-11-15",typescript:!0})},78827:(e,r,t)=>{"use strict";t.d(r,{b:()=>n});var s=t(85685),i=t(84808);async function n(e){let r=await i.db.user.findFirst({where:{id:e},select:{stripeSubscriptionId:!0,stripeCurrentPeriodEnd:!0,stripeCustomerId:!0,stripePriceId:!0}});if(!r)throw Error("User not found");let t=r.stripePriceId&&r.stripeCurrentPeriodEnd?.getTime()+864e5>Date.now();return{...t?s.H:s.R,...r,stripeCurrentPeriodEnd:r.stripeCurrentPeriodEnd?.getTime(),isPro:t}}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[5046,4132,863,8266,1273,232,6265,8088,8930,3613,4539,1835,2774,7785,2814,164,8499,4210],()=>t(72944));module.exports=s})();